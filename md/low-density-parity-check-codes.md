<!--
目的: LDPC符号について理解する
キーワード: unknown...😇
-->

**LDPC(Low-Density Parity-Check)符号**は、1960年代にGallagerによって発見されました。
この符号が注目されるようになったのは30年以上後のMackayによる再発見(1990年代)から[^1]ですが、この再発見により符号理論界にブレイクスルーを起こしました。
現在では、LDPC符号はイーサネットや衛星通信、LTEやWiFiにおける誤り訂正方式として標準化されています。

これほど注目されるようになった大きな理由は、その復号方式によります。
LDPC符号の復号方式は、そのタナ―グラフ(Tanner Graph)が疎であることを活用してsum-product復号法[^2]と呼ばれる方法を使って復号します。
それによって、非常に良いパフォーマンスで復号することが可能になります。
また、適切に符号を設定するとシャノン限界に迫る特性を達成することも大きな理由の一つとして挙げられます。

# LDPC符号の定義
まずは本題のLDPC符号の定義を紹介します。

#### 定義 1.1. LDPC符号(Low-Density Parity-Check Codes)
$H$を${\mathbb F}_2$上の行列とする。$H$の成分に1が少ないとき、$H$を**疎行列(sparse matrix)**といい、
疎行列$H$をパリティ検査行列にもつ線形符号$C$と疎行列$H$のペア$(C, H)$を**LDPC符号(Low-Density Parity-Check Codes)**という。
<br/><br/>

$(C, H)$を単に$C$と書くこともありますが、符号$C$から得られた$H$が疎行列であることは必ずしも言えないため、$C$だけを指してLDPC符号と呼ぶのは好ましくないとされています。

#### 定義 1.2. 正則・非正則LDPC符号(Regular/Irregular LDPC Codes)
LDPC符号$(C, H)$の行列$H$において、全ての列のハミング重みが等しく全ての行のハミング重みが等しいとき、**正則LDPC符号(Regular LDPC Codes)**といい、そうでないとき**非正則LDPC符号(Irregular LDPC Codes)**という。
<br/><br/>

正則LDPC符号は構築しやすく、非正則LDPC符号はパフォーマンスがよりよいといった特徴があります。

# タナ―グラフ
LDPC符号の復号法で重要な役割を持っているタナ―グラフを見ていきます。
タナ―グラフは行列$H$から表される二部グラフのことで、次のように定義されます。

#### 定義 2.1. タナ―グラフ(Tanner Graph)
$H=(h_{i,j})$をサイズが$m\times n$の${\mathbb F}_2$上の行列として、集合$V_c,V_v$をそれぞれ$V_c := \{c_1, c_2, \dots, c_m\}, V_v := \{v_1, v_2, \dots, v_n\}$とする。

集合$V,E$をそれぞれ

\begin{eqnarray}
V &:=& V_c \cup V_v\\
E &:=& \{(c_i, v_j)\in V_c\times V_v\ |\ h_{i,j}=1\}
\end{eqnarray}

としたとき、二部グラフ$G=(V,E)$を**タナ―グラフ(Tanner Graph)**という。また、$V_c$の元を**検査ノード(check nodes)**、$V_v$の元を**変数ノード(variable nodes)**という。

#### 例 2.2.
パリティ検査行列$H$を以下とします:

$$
H = 
\begin{pmatrix}
0 & 1 & 1 & 1 & 1 & 0 & 0 \\
0 & 0 & 1 & 1 & 1 & 1 & 0\\
1 & 1 & 0 & 1 & 0 & 1 & 1\\
\end{pmatrix}.
$$

このとき、$H$から表されるタナ―グラフは次のようになります。

![tanner_graph](images/tanner-graph-ex1.png)

### LDPC符号とタナ―グラフの関係

序論で説明していますが、LDPC符号の復号法はそのタナ―グラフを用いて表されることがほとんどです。
LDPC符号(行列での表現)とタナ―グラフ(グラフでの表現)にはどのような関係があるのでしょうか。

例2.2.を参考にしながら進めていくと、行列と比べてタナ―グラフは**ある列・行に関係している行・列**がわかりやすくなっていることがわかります。
例えば、この$H$を用いて生成された符号語${\textbf c}$は$H\cdot {\textbf c}^{\rm T}={\textbf 0}$と表すことができますが、
検査ノード$c_i(i\in\{1, 2, 3\})$と接続している変数ノードの集合を$V(c_i)$と表すとすると、次のように表すことができます:

$$
\prod_{c_i\in V_c} \delta\left[\sum_{v_j\in V(c_i)} {\textbf c}_{v_j} = 0 \right].
$$

ここで、$\delta[p]$は、$p$が真のときのみ$1$、それ以外は$0$となる関数とします。


また、変数ノード$v_j(j\in\{1,2,\dots,7\})$と接続している検査ノードの集合を$C(v_j)$と表すとすると、定義1.2.は次のように言い換えることができます:

#### 定義1.2.の言い換え
任意の$i, j(i\in\{1, 2,\dots, m\}, j\in\{1,2,\dots,n\})$において、$|V(c_i)|$と$|C(v_j)|$がそれぞれ等しいとき正則、そうでないとき非正則という。
<br/><br/>

このように、LDPC符号のパリティ検査行列$H$で定義されていた概念をタナ―グラフを用いて言い換えることが可能であることがわかったと思います。
復号法のみでなく、**LDPC符号で説明される概念はパリティ検査行列$H$とタナ―グラフの両方の表現で考えることが重要になります。**

# 符号化について
定義1.2.の後に述べていますが、LDPC符号が正則のとき構成するのは簡単ですが、非正則かつ擬巡回(quasi-cyclic)の性質を持っていないときは複雑になります。
その場合の符号化手法の一つである下三角行列(lower-trianglar matrix)での後退代入(back substitution)については参考文献3.で紹介されています。
非正則で擬巡回の場合は、(恐らく)QC-LDPC符号で紹介していると思います。

以上の理由から、ここでの符号化についての説明は割愛します。

# 復号化の概要
復号化についても、ここから説明していくと非常に長くなると考えられるため概要だけを説明します。

復号化において、LDPC符号が優れている理由は、復号法であるsum-product復号法は確率伝播によるものであり、
この確率がパリティ検査行列$H$が疎であるほど良いパフォーマンスで求まるということにあります。
具体的に言うと、$H$のタナ―グラフにサイクルがない、もしくは少ないほうが好まれる傾向にあります。

# 参考文献
1. 井坂元彦,「知識の森」6章 ターボ符号・LDPC符号, _電子情報通信学会_, 2012
2. 萩原学, 「符号理論」, _日本評論社_, 2012
3. Marco Baldi, QC-LDPC Code-Based Cryptography, _Springer_, 2014
4. IEEE, Enhancing the error-correcting performance of LDPC codes for LTE and WiFi, https://ieeexplore.ieee.org/abstract/document/7148600, 2015

[^1]: 当時では、符号長が大きいと計算量が莫大になるなどの理由によって影を潜めていたそうです
[^2]: sum-productアルゴリズム(SPA)に基づく反復復号法(iterative decoding)のこと。ターボ符号(1993~, turbo codes)もこの復号法を使うことができるため注目されています。